import{r as h,j as s,H as P,L as x,a as E}from"./app-CNJch6fJ.js";import{S as M,N as T,A,a as B}from"./NotificationListener-CHbz9J81.js";import{S as F}from"./site-header-1ZLAZI7i.js";import{B as l}from"./button-Bc8fY39k.js";import{C as u,a as N,b as g,c as b,d as v}from"./card-BdiGcNVe.js";import{I as S}from"./input-L_-VHgZB.js";import{L as d}from"./label-Ch3Qpvdb.js";import{S as $,a as H,b as q,c as J,d as z}from"./select-DahuNLv9.js";import{T as w}from"./textarea-2ialuiXC.js";import{s as _}from"./toast-CBrN9sog.js";import{I as R}from"./IconEdit-CcmCEER-.js";import{I as V}from"./IconBuilding-CC5CCjW1.js";import{I as G}from"./IconSettings-BPFF03wv.js";import{I as K}from"./IconArrowLeft-BrOCw4-V.js";import{I as U}from"./IconPlus-DwaGKv2n.js";import{I as O}from"./IconTrash-MfoBVftz.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";import"./createReactComponent-CAvr32i6.js";function us({masterflow:i,jabatans:y,company:k}){const[a,c]=h.useState({name:i.name,description:i.description||"",is_active:i.is_active,steps:i.steps.map(e=>({id:e.id,step_order:e.step_order,step_name:e.step_name,description:e.description||"",is_required:e.is_required,jabatan_id:e.jabatan_id}))}),[n,C]=h.useState({}),[f,j]=h.useState(!1),I=()=>{c({...a,steps:[...a.steps,{id:void 0,step_order:a.steps.length+1,step_name:"",description:"",is_required:!0,jabatan_id:0}]})},L=e=>{const r=a.steps.filter((o,p)=>p!==e).map((o,p)=>({...o,step_order:p+1}));c({...a,steps:r})},m=(e,t,r)=>{const o=[...a.steps];o[e]={...o[e],[t]:r},c({...a,steps:o})},D=e=>{e.preventDefault(),j(!0),E.put(route("admin.masterflows.update",i.id),a,{onSuccess:()=>{_.success("Masterflow berhasil diperbarui.")},onError:t=>{C(t),_.error("Gagal memperbarui masterflow. Periksa form Anda.")},onFinish:()=>j(!1)})};return s.jsxs(s.Fragment,{children:[s.jsx(P,{title:`Edit Masterflow - ${i.name}`}),s.jsxs(M,{children:[s.jsx(T,{}),s.jsx(A,{variant:"inset"}),s.jsxs(B,{children:[s.jsx(F,{}),s.jsx("div",{className:"flex flex-1 flex-col",children:s.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"flex items-center gap-2 font-serif text-2xl font-bold tracking-tight text-foreground",children:[s.jsx(R,{className:"h-6 w-6 text-primary"}),"Edit Masterflow"]}),s.jsxs("p",{className:"flex items-center gap-2 font-sans text-sm text-muted-foreground",children:[s.jsx(V,{className:"h-4 w-4"}),k?.name||"Unknown Company"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(x,{href:route("admin.masterflows.show",i.id),children:s.jsxs(l,{variant:"outline",className:"font-sans",children:[s.jsx(G,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]})}),s.jsx(x,{href:route("admin.masterflows.index"),children:s.jsxs(l,{variant:"outline",className:"font-sans",children:[s.jsx(K,{className:"mr-2 h-4 w-4"}),"Kembali"]})})]})]}),s.jsxs("form",{onSubmit:D,className:"space-y-6",children:[s.jsxs(u,{className:"border-border bg-card",children:[s.jsxs(N,{children:[s.jsx(g,{className:"font-serif text-foreground",children:"Informasi Masterflow"}),s.jsx(b,{className:"font-sans",children:"Perbarui informasi dasar masterflow."})]}),s.jsxs(v,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"name",className:"font-sans",children:"Nama Masterflow *"}),s.jsx(S,{id:"name",value:a.name,onChange:e=>c({...a,name:e.target.value}),placeholder:"Contoh: Approval Surat Permohonan",className:"font-sans"}),n.name&&s.jsx("p",{className:"font-sans text-sm text-red-600",children:n.name})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{htmlFor:"description",className:"font-sans",children:"Deskripsi"}),s.jsx(w,{id:"description",value:a.description,onChange:e=>c({...a,description:e.target.value}),placeholder:"Deskripsi singkat tentang masterflow ini",rows:3,className:"font-sans"}),n.description&&s.jsx("p",{className:"font-sans text-sm text-red-600",children:n.description})]})]})]}),s.jsxs(u,{className:"border-border bg-card",children:[s.jsx(N,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(g,{className:"font-serif text-foreground",children:"Langkah Approval"}),s.jsx(b,{className:"font-sans",children:"Perbarui urutan langkah approval yang diperlukan."})]}),s.jsxs(l,{type:"button",onClick:I,variant:"outline",size:"sm",className:"font-sans",children:[s.jsx(U,{className:"mr-2 h-4 w-4"}),"Tambah Langkah"]})]})}),s.jsxs(v,{className:"space-y-4",children:[a.steps.map((e,t)=>s.jsxs("div",{className:"space-y-4 rounded-lg border border-border p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h4",{className:"font-sans font-semibold text-foreground",children:["Langkah ",e.step_order]}),a.steps.length>1&&s.jsx(l,{type:"button",variant:"ghost",size:"sm",onClick:()=>L(t),children:s.jsx(O,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{className:"font-sans",children:"Nama Langkah *"}),s.jsx(S,{value:e.step_name,onChange:r=>m(t,"step_name",r.target.value),placeholder:"Contoh: Review Manager",className:"font-sans"}),n[`steps.${t}.step_name`]&&s.jsx("p",{className:"font-sans text-sm text-red-600",children:n[`steps.${t}.step_name`]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{className:"font-sans",children:"Jabatan yang Bertanggung Jawab *"}),s.jsxs($,{value:e.jabatan_id.toString(),onValueChange:r=>m(t,"jabatan_id",parseInt(r)),children:[s.jsx(H,{className:"font-sans",children:s.jsx(q,{placeholder:"Pilih Jabatan"})}),s.jsx(J,{children:y.map(r=>s.jsx(z,{value:r.id.toString(),className:"font-sans",children:r.name},r.id))})]}),n[`steps.${t}.jabatan_id`]&&s.jsx("p",{className:"font-sans text-sm text-red-600",children:n[`steps.${t}.jabatan_id`]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(d,{className:"font-sans",children:"Deskripsi Langkah"}),s.jsx(w,{value:e.description,onChange:r=>m(t,"description",r.target.value),placeholder:"Deskripsi tentang apa yang dilakukan pada langkah ini",rows:2,className:"font-sans"})]})]},e.id||t)),n.steps&&s.jsx("p",{className:"font-sans text-sm text-red-600",children:n.steps})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[s.jsx(x,{href:route("admin.masterflows.index"),children:s.jsx(l,{type:"button",variant:"outline",className:"font-sans",children:"Batal"})}),s.jsx(l,{type:"submit",disabled:f,className:"font-sans",children:f?"Menyimpan...":"Perbarui Masterflow"})]})]})]})})})]})]})]})}export{us as default};
