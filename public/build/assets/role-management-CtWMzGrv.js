import{r as t,j as e,H as _}from"./app-CNJch6fJ.js";import{S as R,N as C,A as D,a as I,B as $}from"./NotificationListener-CHbz9J81.js";import{S as T}from"./site-header-1ZLAZI7i.js";import{B as c}from"./button-Bc8fY39k.js";import{C as M,d as k,a as z,b as O,c as q}from"./card-BdiGcNVe.js";import{I as K}from"./input-L_-VHgZB.js";import{L as G}from"./label-Ch3Qpvdb.js";import{T as J,a as Q,b as y,c as d,d as U,e as n}from"./table-dbNKOOTV.js";import{a as h}from"./api-BCiONhZ8.js";import{s as a}from"./toast-CBrN9sog.js";import{I as V}from"./IconShield-VS74m0Xt.js";import{A as W}from"./activity-5R1ujG4d.js";import{I as X}from"./IconPlus-DwaGKv2n.js";import{I as Y}from"./IconEdit-CcmCEER-.js";import{I as Z}from"./IconTrash-MfoBVftz.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";import"./createReactComponent-CAvr32i6.js";function ye(){const[u,v]=t.useState([]),[E,p]=t.useState(!1),[i,j]=t.useState(null),[A,B]=t.useState(!0),[g,w]=t.useState(!1),[o,m]=t.useState({role_name:""});t.useEffect(()=>{N()},[]),t.useEffect(()=>{const s=window.Echo?.channel("role-management");return s&&s.listen("role.updated",r=>{const{action:b,role:l}=r;v(x=>{switch(b){case"created":return a.realtime.created(l.role_name,"role"),[...x,l];case"updated":return a.realtime.updated(l.role_name,"role"),x.map(f=>f.id===l.id?l:f);case"deleted":return a.realtime.deleted("Role"),x.filter(f=>f.id!==l.id);default:return x}})}),()=>{s&&s.stopListening("role.updated")}},[]);const N=async()=>{try{const s=await h.get("/roles");v(s.data.roles)}catch{a.error("âŒ Failed to fetch roles. Please try again.")}finally{B(!1)}},L=async s=>{s.preventDefault(),w(!0);try{i?(await h.put(`/roles/${i.id}`,o),a.success(`ðŸŽ‰ Role "${o.role_name}" updated successfully!`)):(await h.post("/roles",o),a.success(`ðŸŽ‰ Role "${o.role_name}" created successfully!`)),S(),N()}catch(r){a.error(`âŒ ${r.response?.data?.message||"Something went wrong. Please try again."}`)}finally{w(!1)}},P=s=>{j(s),m({role_name:s.role_name}),p(!0)},F=async(s,r)=>{a.confirmDelete(r,async()=>{try{await h.delete(`/roles/${s}`),a.success("ðŸ—‘ï¸ Role deleted successfully!"),N()}catch(b){a.error(`âŒ ${b.response?.data?.message||"Failed to delete role. Please try again."}`)}},"role")},H=()=>{j(null),m({role_name:""}),p(!0)},S=()=>{p(!1),j(null),m({role_name:""})};return A?e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Super Admin - Role Management"}),e.jsxs(R,{children:[e.jsx(C,{}),e.jsx(D,{variant:"inset"}),e.jsxs(I,{children:[e.jsx(T,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-b-2 border-primary"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading data role..."})]})})})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Super Admin - Role Management"}),e.jsxs(R,{children:[e.jsx(C,{}),e.jsx(D,{variant:"inset"}),e.jsxs(I,{children:[e.jsx(T,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"flex items-center gap-3 font-sans text-3xl font-bold tracking-tight text-foreground",children:[e.jsx(V,{className:"h-8 w-8 text-primary"}),"Master Role Management"]}),e.jsx("p",{className:"font-sans text-base text-muted-foreground",children:"Kelola dan atur master role global dalam sistem"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{variant:"outline",className:"border-primary/30 bg-primary/10 font-sans text-sm font-medium text-primary",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),u.length," Roles"]}),e.jsxs(c,{onClick:H,className:"gap-2 font-sans font-medium",children:[e.jsx(X,{className:"h-4 w-4"}),"Tambah Role"]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(M,{className:"border-border bg-card",children:e.jsx(k,{className:"p-0",children:e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(y,{children:[e.jsx(d,{className:"font-sans",children:"No"}),e.jsx(d,{className:"font-sans",children:"Nama Role"}),e.jsx(d,{className:"font-sans",children:"Dibuat"}),e.jsx(d,{className:"font-sans",children:"Diperbarui"}),e.jsx(d,{className:"text-right font-sans",children:"Aksi"})]})}),e.jsx(U,{children:u.length>0?u.map((s,r)=>e.jsxs(y,{children:[e.jsx(n,{className:"font-mono",children:r+1}),e.jsx(n,{className:"font-sans font-medium",children:s.role_name}),e.jsx(n,{className:"font-sans",children:new Date(s.created_at).toLocaleDateString("id-ID")}),e.jsx(n,{className:"font-sans",children:new Date(s.updated_at).toLocaleDateString("id-ID")}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>P(s),className:"h-8 w-8 border-blue-300 p-0 text-blue-600 hover:bg-blue-50",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>F(s.id,s.role_name),className:"h-8 w-8 border-red-300 p-0 text-red-600 hover:bg-red-50",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(y,{children:e.jsx(n,{colSpan:5,className:"py-8 text-center font-sans text-gray-500",children:"Belum ada role yang tersedia"})})})]})})})}),E&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs(M,{className:"mx-4 w-full max-w-md",children:[e.jsxs(z,{children:[e.jsx(O,{className:"font-serif",children:i?"Edit Master Role":"Tambah Master Role Baru"}),e.jsx(q,{className:"font-sans",children:i?"Perbarui informasi master role global":"Tambahkan master role baru ke sistem"})]}),e.jsx(k,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"role_name",className:"font-sans",children:"Nama Role"}),e.jsx(K,{id:"role_name",value:o.role_name,onChange:s=>m({role_name:s.target.value}),placeholder:"Masukkan nama role",className:"font-sans",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:S,disabled:g,className:"font-sans",children:"Batal"}),e.jsx(c,{type:"submit",disabled:g,className:"bg-red-600 font-sans hover:bg-red-700",children:g?"Menyimpan...":i?"Perbarui":"Simpan"})]})]})})]})})]})})})]})]})]})}export{ye as default};
