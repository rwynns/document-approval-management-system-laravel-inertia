import{r as o,j as e,H as _e}from"./app-CNJch6fJ.js";import{z as H,F as Ce,T as Re,G as Ee,W as be,f as Se,H as Te,e as Ie,J as Oe,K as Pe,L as W,O as $e,B as ke}from"./NotificationListener-CHbz9J81.js";import{u as G,f as Me,c as d,g as J,B as u}from"./button-Bc8fY39k.js";import{C as Le,a as Ue,b as Fe,c as ze,d as Be}from"./card-BdiGcNVe.js";import{D as P,a as $,b as k,c as M,d as L,e as U}from"./dialog-BDMnm7Fp.js";import{I as E}from"./input-L_-VHgZB.js";import{L as F}from"./label-Ch3Qpvdb.js";import{T as He,a as We,b as z,c as v,d as Ge,e as N}from"./table-dbNKOOTV.js";import{u as Je}from"./AuthContext-Cflniwk8.js";import{A as Ke}from"./app-layout-VNzkGBAB.js";import{I as B}from"./IconShield-VS74m0Xt.js";import{A as Qe}from"./activity-5R1ujG4d.js";import{I as Ve}from"./IconPlus-DwaGKv2n.js";import{S as Ye}from"./search-DwR1Q8ba.js";import{I as qe}from"./IconUsers-DGqKWc1T.js";import{I as Xe}from"./IconEdit-CcmCEER-.js";import{I as Ze}from"./IconTrash-MfoBVftz.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";import"./api-BCiONhZ8.js";import"./chevron-right-D5vTS9_Z.js";import"./createReactComponent-CAvr32i6.js";var K="AlertDialog",[ea,za]=Se(K,[H]),i=H(),Q=a=>{const{__scopeAlertDialog:t,...r}=a,l=i(t);return e.jsx(Ce,{...l,...r,modal:!0})};Q.displayName=K;var aa="AlertDialogTrigger",V=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,n=i(r);return e.jsx(Re,{...n,...l,ref:t})});V.displayName=aa;var ta="AlertDialogPortal",Y=a=>{const{__scopeAlertDialog:t,...r}=a,l=i(t);return e.jsx(Ee,{...l,...r})};Y.displayName=ta;var sa="AlertDialogOverlay",q=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,n=i(r);return e.jsx($e,{...n,...l,ref:t})});q.displayName=sa;var x="AlertDialogContent",[ra,oa]=ea(x),la=Me("AlertDialogContent"),X=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,children:l,...n}=a,m=i(r),g=o.useRef(null),w=G(t,g),p=o.useRef(null);return e.jsx(be,{contentName:x,titleName:Z,docsSlug:"alert-dialog",children:e.jsx(ra,{scope:r,cancelRef:p,children:e.jsxs(Te,{role:"alertdialog",...m,...n,ref:w,onOpenAutoFocus:Ie(n.onOpenAutoFocus,h=>{h.preventDefault(),p.current?.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[e.jsx(la,{children:l}),e.jsx(ia,{contentRef:g})]})})})});X.displayName=x;var Z="AlertDialogTitle",ee=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,n=i(r);return e.jsx(Oe,{...n,...l,ref:t})});ee.displayName=Z;var ae="AlertDialogDescription",te=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,n=i(r);return e.jsx(Pe,{...n,...l,ref:t})});te.displayName=ae;var na="AlertDialogAction",se=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,n=i(r);return e.jsx(W,{...n,...l,ref:t})});se.displayName=na;var re="AlertDialogCancel",oe=o.forwardRef((a,t)=>{const{__scopeAlertDialog:r,...l}=a,{cancelRef:n}=oa(re,r),m=i(r),g=G(t,n);return e.jsx(W,{...m,...l,ref:g})});oe.displayName=re;var ia=({contentRef:a})=>{const t=`\`${x}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${x}\` by passing a \`${ae}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${x}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},ca=Q,da=V,ma=Y,le=q,ne=X,ie=se,ce=oe,de=ee,me=te;const pa=ca,ha=da,ua=ma,pe=o.forwardRef(({className:a,...t},r)=>e.jsx(le,{className:d("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:r}));pe.displayName=le.displayName;const he=o.forwardRef(({className:a,...t},r)=>e.jsxs(ua,{children:[e.jsx(pe,{}),e.jsx(ne,{ref:r,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));he.displayName=ne.displayName;const ue=({className:a,...t})=>e.jsx("div",{className:d("flex flex-col space-y-2 text-center sm:text-left",a),...t});ue.displayName="AlertDialogHeader";const ge=({className:a,...t})=>e.jsx("div",{className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});ge.displayName="AlertDialogFooter";const xe=o.forwardRef(({className:a,...t},r)=>e.jsx(de,{ref:r,className:d("text-lg font-semibold",a),...t}));xe.displayName=de.displayName;const fe=o.forwardRef(({className:a,...t},r)=>e.jsx(me,{ref:r,className:d("text-sm text-muted-foreground",a),...t}));fe.displayName=me.displayName;const je=o.forwardRef(({className:a,...t},r)=>e.jsx(ie,{ref:r,className:d(J(),a),...t}));je.displayName=ie.displayName;const ve=o.forwardRef(({className:a,...t},r)=>e.jsx(ce,{ref:r,className:d(J({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));ve.displayName=ce.displayName;const ga=[{title:"Dashboard",href:"/dashboard"},{title:"User Roles Management",href:"/user-roles"}];function Ba(){const{user:a}=Je(),[t,r]=o.useState([]),[l,n]=o.useState(!0),[m,g]=o.useState(""),[w,p]=o.useState(!1),[h,A]=o.useState(!1),[_,b]=o.useState(null),[y,S]=o.useState(""),[D,C]=o.useState(""),[T,Ne]=o.useState({current_page:1,last_page:1,per_page:10,total:0}),c=async(s=1,f="")=>{try{n(!0);const R=new URLSearchParams({page:s.toString(),per_page:T.per_page.toString(),...f&&{search:f}}),O=await fetch(`/api/user-roles?${R}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth-token")}`,Accept:"application/json"}});if(O.ok){const j=await O.json();r(j.data.data),Ne({current_page:j.data.current_page,last_page:j.data.last_page,per_page:j.data.per_page,total:j.data.total})}}catch(R){console.error("Error fetching roles:",R)}finally{n(!1)}},Ae=async()=>{try{(await fetch("/api/user-roles",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth-token")}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({role_name:y})})).ok&&(S(""),p(!1),c(),window.Echo&&window.Echo.channel("roles").whisper("role.created",{role_name:y,user:a?.name}))}catch(s){console.error("Error creating role:",s)}},ye=async()=>{if(_)try{(await fetch(`/api/user-roles/${_.id}`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("auth-token")}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({role_name:D})})).ok&&(C(""),b(null),A(!1),c(),window.Echo&&window.Echo.channel("roles").whisper("role.updated",{role_name:D,old_name:_.role_name,user:a?.name}))}catch(s){console.error("Error updating role:",s)}},De=async s=>{try{(await fetch(`/api/user-roles/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth-token")}`,Accept:"application/json"}})).ok&&(c(),window.Echo&&window.Echo.channel("roles").whisper("role.deleted",{role_name:s.role_name,user:a?.name}))}catch(f){console.error("Error deleting role:",f)}};o.useEffect(()=>{if(c(),window.Echo){const s=window.Echo.channel("roles");return s.listenForWhisper("role.created",()=>{c()}),s.listenForWhisper("role.updated",()=>{c()}),s.listenForWhisper("role.deleted",()=>{c()}),()=>{window.Echo.leaveChannel("roles")}}},[]),o.useEffect(()=>{const s=setTimeout(()=>{c(1,m)},500);return()=>clearTimeout(s)},[m]);const we=s=>{b(s),C(s.role_name),A(!0)},I=s=>new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(Ke,{breadcrumbs:ga,children:[e.jsx(_e,{title:"User Roles Management"}),e.jsx("div",{className:"flex min-h-screen flex-1 flex-col bg-white",children:e.jsxs("div",{className:"@container/main flex flex-1 flex-col",children:[e.jsxs("div",{className:"px-4 py-6 lg:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h1",{className:"flex items-center gap-2 font-serif text-2xl font-bold tracking-tight text-gray-900",children:[e.jsx(B,{className:"h-6 w-6 text-primary"}),"User Roles Management"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kelola user roles dengan fitur realtime menggunakan Laravel Sanctum API"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsx("span",{children:"Realtime Updates Active"}),e.jsxs(ke,{variant:"outline",className:"text-xs",children:["Total: ",T.total," roles"]})]})]}),e.jsxs(u,{onClick:()=>p(!0),children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Add New Role"]})]}),e.jsxs("div",{className:"relative mt-4 max-w-md",children:[e.jsx(Ye,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(E,{placeholder:"Search roles...",value:m,onChange:s=>g(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex-1 px-4 pb-8 lg:px-6",children:e.jsxs(Le,{children:[e.jsxs(Ue,{children:[e.jsx(Fe,{children:"User Roles"}),e.jsx(ze,{children:"Daftar role pengguna dalam sistem"})]}),e.jsx(Be,{children:l?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading roles..."})}):e.jsxs(He,{children:[e.jsx(We,{children:e.jsxs(z,{children:[e.jsx(v,{children:"Role Name"}),e.jsx(v,{children:"Users Count"}),e.jsx(v,{children:"Created"}),e.jsx(v,{children:"Updated"}),e.jsx(v,{className:"text-right",children:"Actions"})]})}),e.jsx(Ge,{children:t.map(s=>e.jsxs(z,{children:[e.jsx(N,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),s.formatted_role_name||s.role_name]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.users_count||0})]})}),e.jsx(N,{className:"text-muted-foreground",children:I(s.created_at)}),e.jsx(N,{className:"text-muted-foreground",children:I(s.updated_at)}),e.jsx(N,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>we(s),children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsxs(pa,{children:[e.jsx(ha,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",children:e.jsx(Ze,{className:"h-4 w-4"})})}),e.jsxs(he,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:"Delete Role"}),e.jsxs(fe,{children:['Are you sure you want to delete the role "',s.role_name,'"? This action cannot be undone.']})]}),e.jsxs(ge,{children:[e.jsx(ve,{children:"Cancel"}),e.jsx(je,{onClick:()=>De(s),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})})]},s.id))})]})})]})})]})}),e.jsx(P,{open:w,onOpenChange:p,children:e.jsxs($,{children:[e.jsxs(k,{children:[e.jsx(M,{children:"Create New Role"}),e.jsx(L,{children:"Add a new user role to the system."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(F,{htmlFor:"role_name",children:"Role Name"}),e.jsx(E,{id:"role_name",value:y,onChange:s=>S(s.target.value),placeholder:"Enter role name..."})]})}),e.jsxs(U,{children:[e.jsx(u,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(u,{onClick:Ae,disabled:!y.trim(),children:"Create Role"})]})]})}),e.jsx(P,{open:h,onOpenChange:A,children:e.jsxs($,{children:[e.jsxs(k,{children:[e.jsx(M,{children:"Edit Role"}),e.jsx(L,{children:"Update the role information."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(F,{htmlFor:"edit_role_name",children:"Role Name"}),e.jsx(E,{id:"edit_role_name",value:D,onChange:s=>C(s.target.value),placeholder:"Enter role name..."})]})}),e.jsxs(U,{children:[e.jsx(u,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsx(u,{onClick:ye,disabled:!D.trim(),children:"Update Role"})]})]})})]})}export{Ba as default};
