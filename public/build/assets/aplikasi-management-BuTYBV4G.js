import{r as t,j as e,H as w}from"./app-CNJch6fJ.js";import{S as A,N as C,A as I,a as T,B as R}from"./NotificationListener-CHbz9J81.js";import{S as M}from"./site-header-1ZLAZI7i.js";import{B as d}from"./button-Bc8fY39k.js";import{C as _,d as P,a as V,b as K,c as U}from"./card-BdiGcNVe.js";import{I as G}from"./input-L_-VHgZB.js";import{L as E}from"./label-Ch3Qpvdb.js";import{S as J,a as Q,b as W,c as X,d as Y}from"./select-DahuNLv9.js";import{T as Z,a as ee,b,c as x,d as ae,e as m}from"./table-dbNKOOTV.js";import{a as h}from"./api-BCiONhZ8.js";import{s as i}from"./toast-CBrN9sog.js";import{I as se}from"./IconUsers-DGqKWc1T.js";import{A as ie}from"./activity-5R1ujG4d.js";import{I as te}from"./IconPlus-DwaGKv2n.js";import{I as ne}from"./IconEdit-CcmCEER-.js";import{I as re}from"./IconTrash-MfoBVftz.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";import"./createReactComponent-CAvr32i6.js";function Te(){const[f,k]=t.useState([]),[B,F]=t.useState([]),[D,u]=t.useState(!1),[l,j]=t.useState(null),[H,L]=t.useState(!0),[g,v]=t.useState(!1),[n,c]=t.useState({name:"",company_id:""});t.useEffect(()=>{N()},[]),t.useEffect(()=>{const a=window.Echo?.channel("aplikasi-management");return a&&a.listen("aplikasi.updated",s=>{const{action:y,aplikasi:r}=s;k(o=>{switch(y){case"created":return i.realtime.created(r.name,"aplikasi"),[...o,r];case"updated":return i.realtime.updated(r.name,"aplikasi"),o.map(p=>p.id===r.id?r:p);case"deleted":return i.realtime.deleted("Aplikasi"),o.filter(p=>p.id!==r.id);default:return o}})}),()=>{a&&a.stopListening("aplikasi.updated")}},[]);const N=async()=>{try{console.log("Fetching aplikasis...");const a=await h.get("/aplikasis");console.log("Aplikasis response:",a),k(a.data.aplikasis),F(a.data.companies)}catch(a){console.error("Aplikasis fetch error:",a),i.error("âŒ Failed to fetch aplikasis. Please try again.")}finally{L(!1)}},$=async a=>{a.preventDefault(),v(!0);try{const s={name:n.name,company_id:parseInt(n.company_id)};l?(await h.put(`/aplikasis/${l.id}`,s),i.success(`ðŸŽ‰ Aplikasi "${n.name}" updated successfully!`)):(await h.post("/aplikasis",s),i.success(`ðŸŽ‰ Aplikasi "${n.name}" created successfully!`)),S(),N()}catch(s){i.error(`âŒ ${s.response?.data?.message||"Something went wrong. Please try again."}`)}finally{v(!1)}},z=a=>{j(a),c({name:a.name,company_id:a.company_id.toString()}),u(!0)},q=async(a,s)=>{i.confirmDelete(s,async()=>{try{await h.delete(`/aplikasis/${a}`),i.success("ðŸ—‘ï¸ Aplikasi deleted successfully!"),N()}catch(y){i.error(`âŒ ${y.response?.data?.message||"Failed to delete aplikasi. Please try again."}`)}},"aplikasi")},O=()=>{j(null),c({name:"",company_id:""}),u(!0)},S=()=>{u(!1),j(null),c({name:"",company_id:""})};return H?e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Super Admin - Aplikasi Management"}),e.jsxs(A,{children:[e.jsx(C,{}),e.jsx(I,{variant:"inset"}),e.jsxs(T,{children:[e.jsx(M,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-b-2 border-primary"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading data aplikasi..."})]})})})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Super Admin - Aplikasi Management"}),e.jsxs(A,{children:[e.jsx(C,{}),e.jsx(I,{variant:"inset"}),e.jsxs(T,{children:[e.jsx(M,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"flex items-center gap-3 font-sans text-3xl font-bold tracking-tight text-foreground",children:[e.jsx(se,{className:"h-8 w-8 text-primary"}),"Master Aplikasi Management"]}),e.jsx("p",{className:"font-sans text-base text-muted-foreground",children:"Kelola dan atur master aplikasi berdasarkan perusahaan"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(R,{variant:"outline",className:"border-primary/30 bg-primary/10 font-sans text-sm font-medium text-primary",children:[e.jsx(ie,{className:"mr-1 h-3 w-3"}),f.length," Aplikasis"]}),e.jsxs(d,{onClick:O,className:"gap-2 font-sans font-medium",children:[e.jsx(te,{className:"h-4 w-4"}),"Tambah Aplikasi"]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(_,{className:"border-border bg-card",children:e.jsx(P,{className:"p-0",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(b,{children:[e.jsx(x,{className:"w-16 font-sans",children:"No"}),e.jsx(x,{className:"w-64 font-sans",children:"Nama Aplikasi"}),e.jsx(x,{className:"font-sans",children:"Perusahaan"}),e.jsx(x,{className:"w-24 text-right font-sans",children:"Aksi"})]})}),e.jsx(ae,{children:f.length>0?f.map((a,s)=>e.jsxs(b,{children:[e.jsx(m,{className:"font-mono",children:s+1}),e.jsx(m,{className:"font-sans font-medium",children:a.name}),e.jsx(m,{className:"font-sans",children:a.company.name}),e.jsx(m,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>z(a),className:"h-8 w-8 border-blue-300 p-0 text-blue-600 hover:bg-blue-50",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>q(a.id,a.name),className:"h-8 w-8 border-red-300 p-0 text-red-600 hover:bg-red-50",children:e.jsx(re,{className:"h-4 w-4"})})]})})]},a.id)):e.jsx(b,{children:e.jsx(m,{colSpan:4,className:"py-8 text-center font-sans text-gray-500",children:"Belum ada aplikasi yang tersedia"})})})]})})})})]})})})]}),D&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs(_,{className:"mx-4 w-full max-w-lg",children:[e.jsxs(V,{children:[e.jsx(K,{className:"font-serif",children:l?"Edit Master Aplikasi":"Tambah Master Aplikasi Baru"}),e.jsx(U,{className:"font-sans",children:l?"Perbarui informasi master aplikasi":"Tambahkan master aplikasi baru ke sistem"})]}),e.jsx(P,{children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"name",className:"font-sans",children:["Nama Aplikasi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(G,{id:"name",value:n.name,onChange:a=>c(s=>({...s,name:a.target.value})),placeholder:"Masukkan nama aplikasi",className:"font-sans",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"company_id",className:"font-sans",children:["Perusahaan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(J,{value:n.company_id,onValueChange:a=>c(s=>({...s,company_id:a})),required:!0,children:[e.jsx(Q,{className:"font-sans",children:e.jsx(W,{placeholder:"Pilih perusahaan"})}),e.jsx(X,{children:B.map(a=>e.jsx(Y,{value:a.id.toString(),className:"font-sans",children:a.name},a.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(d,{type:"button",variant:"outline",onClick:S,disabled:g,className:"font-sans",children:"Batal"}),e.jsx(d,{type:"submit",disabled:g,className:"bg-red-600 font-sans hover:bg-red-700",children:g?"Menyimpan...":l?"Perbarui":"Simpan"})]})]})})]})})]})]})}export{Te as default};
