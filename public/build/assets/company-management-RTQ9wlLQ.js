import{r,j as e,H as k}from"./app-CNJch6fJ.js";import{S as T,N as M,A as I,a as _,B as R}from"./NotificationListener-CHbz9J81.js";import{S as A}from"./site-header-1ZLAZI7i.js";import{B as c}from"./button-Bc8fY39k.js";import{C as P,d as B,a as q,b as K,c as G}from"./card-BdiGcNVe.js";import{I as E}from"./input-L_-VHgZB.js";import{L as y}from"./label-Ch3Qpvdb.js";import{T as J,a as Q,b as v,c as m,d as U,e as o}from"./table-dbNKOOTV.js";import{a as p}from"./api-BCiONhZ8.js";import{s as n}from"./toast-CBrN9sog.js";import{I as V}from"./IconBuilding-CC5CCjW1.js";import{A as W}from"./activity-5R1ujG4d.js";import{I as X}from"./IconPlus-DwaGKv2n.js";import{I as Y}from"./IconEdit-CcmCEER-.js";import{I as Z}from"./IconTrash-MfoBVftz.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";import"./createReactComponent-CAvr32i6.js";function ye(){const[u,w]=r.useState([]),[F,f]=r.useState(!1),[d,j]=r.useState(null),[L,D]=r.useState(!0),[b,C]=r.useState(!1),[t,l]=r.useState({name:"",address:"",phone_number:""});r.useEffect(()=>{g()},[]),r.useEffect(()=>{const a=window.Echo?.channel("company-management");return a&&a.listen("company.updated",s=>{const{action:N,company:i}=s;w(x=>{switch(N){case"created":return n.realtime.created(i.name,"company"),[...x,i];case"updated":return n.realtime.updated(i.name,"company"),x.map(h=>h.id===i.id?i:h);case"deleted":return n.realtime.deleted("Company"),x.filter(h=>h.id!==i.id);default:return x}})}),()=>{a&&a.stopListening("company.updated")}},[]);const g=async()=>{try{const a=await p.get("/companies");w(a.data.companies)}catch{n.error("âŒ Failed to fetch companies. Please try again.")}finally{D(!1)}},H=async a=>{a.preventDefault(),C(!0);try{d?(await p.put(`/companies/${d.id}`,t),n.success(`ðŸŽ‰ Company "${t.name}" updated successfully!`)):(await p.post("/companies",t),n.success(`ðŸŽ‰ Company "${t.name}" created successfully!`)),S(),g()}catch(s){n.error(`âŒ ${s.response?.data?.message||"Something went wrong. Please try again."}`)}finally{C(!1)}},$=a=>{j(a),l({name:a.name,address:a.address||"",phone_number:a.phone_number||""}),f(!0)},z=async(a,s)=>{n.confirmDelete(s,async()=>{try{await p.delete(`/companies/${a}`),n.success("ðŸ—‘ï¸ Company deleted successfully!"),g()}catch(N){n.error(`âŒ ${N.response?.data?.message||"Failed to delete company. Please try again."}`)}},"company")},O=()=>{j(null),l({name:"",address:"",phone_number:""}),f(!0)},S=()=>{f(!1),j(null),l({name:"",address:"",phone_number:""})};return L?e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Super Admin - Company Management"}),e.jsxs(T,{children:[e.jsx(M,{}),e.jsx(I,{variant:"inset"}),e.jsxs(_,{children:[e.jsx(A,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-b-2 border-primary"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading data perusahaan..."})]})})})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Super Admin - Company Management"}),e.jsxs(T,{children:[e.jsx(M,{}),e.jsx(I,{variant:"inset"}),e.jsxs(_,{children:[e.jsx(A,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsxs("div",{className:"@container/main flex flex-1 flex-col gap-2 p-6",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("h1",{className:"flex items-center gap-3 font-sans text-3xl font-bold tracking-tight text-foreground",children:[e.jsx(V,{className:"h-8 w-8 text-primary"}),"Master Company Management"]}),e.jsx("p",{className:"font-sans text-base text-muted-foreground",children:"Kelola dan atur master perusahaan dalam sistem"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(R,{variant:"outline",className:"border-primary/30 bg-primary/10 font-sans text-sm font-medium text-primary",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),u.length," Companies"]}),e.jsxs(c,{onClick:O,className:"gap-2 font-sans font-medium",children:[e.jsx(X,{className:"h-4 w-4"}),"Tambah Company"]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(P,{className:"border-border bg-card",children:e.jsx(B,{className:"p-0",children:e.jsxs(J,{children:[e.jsx(Q,{children:e.jsxs(v,{children:[e.jsx(m,{className:"w-16 font-sans",children:"No"}),e.jsx(m,{className:"w-48 font-sans",children:"Nama Perusahaan"}),e.jsx(m,{className:"w-80 font-sans",children:"Alamat"}),e.jsx(m,{className:"w-32 font-sans",children:"Nomor Telepon"}),e.jsx(m,{className:"w-24 text-right font-sans",children:"Aksi"})]})}),e.jsx(U,{children:u.length>0?u.map((a,s)=>e.jsxs(v,{children:[e.jsx(o,{className:"font-mono",children:s+1}),e.jsx(o,{className:"font-sans font-medium",children:a.name}),e.jsx(o,{className:"w-80 font-sans",children:a.address?e.jsx("div",{className:"break-words whitespace-normal",children:a.address}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(o,{className:"font-sans",children:a.phone_number||e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(o,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>$(a),className:"h-8 w-8 border-blue-300 p-0 text-blue-600 hover:bg-blue-50",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>z(a.id,a.name),className:"h-8 w-8 border-red-300 p-0 text-red-600 hover:bg-red-50",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},a.id)):e.jsx(v,{children:e.jsx(o,{colSpan:5,className:"py-8 text-center font-sans text-gray-500",children:"Belum ada perusahaan yang tersedia"})})})]})})})})]})})]}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs(P,{className:"mx-4 w-full max-w-lg",children:[e.jsxs(q,{children:[e.jsx(K,{className:"font-serif",children:d?"Edit Master Company":"Tambah Master Company Baru"}),e.jsx(G,{className:"font-sans",children:d?"Perbarui informasi master perusahaan":"Tambahkan master perusahaan baru ke sistem"})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(y,{htmlFor:"name",className:"font-sans",children:["Nama Perusahaan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(E,{id:"name",value:t.name,onChange:a=>l(s=>({...s,name:a.target.value})),placeholder:"Masukkan nama perusahaan",className:"font-sans",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"address",className:"font-sans",children:"Alamat Perusahaan"}),e.jsx("textarea",{id:"address",value:t.address,onChange:a=>l(s=>({...s,address:a.target.value})),placeholder:"Masukkan alamat perusahaan",className:"flex min-h-[80px] w-full resize-none rounded-md border border-input bg-background px-3 py-2 font-sans text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"phone_number",className:"font-sans",children:"Nomor Telepon"}),e.jsx(E,{id:"phone_number",value:t.phone_number,onChange:a=>l(s=>({...s,phone_number:a.target.value})),placeholder:"Masukkan nomor telepon",className:"font-sans",maxLength:20})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:S,disabled:b,className:"font-sans",children:"Batal"}),e.jsx(c,{type:"submit",disabled:b,className:"bg-red-600 font-sans hover:bg-red-700",children:b?"Menyimpan...":d?"Perbarui":"Simpan"})]})]})})]})})]})]})}export{ye as default};
