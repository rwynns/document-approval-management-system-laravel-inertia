import{r as e,j as v}from"./app-CNJch6fJ.js";import{a as n}from"./api-BCiONhZ8.js";const m=e.createContext(void 0),E=()=>{const o=e.useContext(m);if(o===void 0)throw new Error("useAuth must be used within an AuthProvider");return o},j=({children:o})=>{const[k,s]=e.useState(null),[u,a]=e.useState(localStorage.getItem("auth-token")),[p,g]=e.useState(!0);e.useEffect(()=>{u?d():g(!1)},[u]);const d=async()=>{try{const t=await n.get("/user");s(t.data.user)}catch{localStorage.removeItem("auth-token"),a(null)}finally{g(!1)}},f={user:k,token:u,login:async(t,c)=>{const l=await n.post("/login",{email:t,password:c}),{user:i,token:r}=l.data;localStorage.setItem("auth-token",r),a(r),s(i)},logout:async()=>{try{await n.post("/logout")}catch{}finally{localStorage.removeItem("auth-token"),a(null),s(null)}},register:async(t,c,l,i)=>{const r=await n.post("/register",{name:t,email:c,password:l,password_confirmation:i}),{user:x,token:h}=r.data;localStorage.setItem("auth-token",h),a(h),s(x)},loading:p};return v.jsx(m.Provider,{value:f,children:o})};export{j as A,E as u};
