import{r as i,j as e,u as $,H as Y,a as Q}from"./app-CNJch6fJ.js";import{X as ee,B as A,S as ae,N as se,A as te,a as re,b as ne}from"./NotificationListener-CHbz9J81.js";import{a as M,B as u}from"./button-Bc8fY39k.js";import{C as v,a as E,b as U,c as L,d as k}from"./card-BdiGcNVe.js";import{D as le,a as ie,b as oe,c as ce,d as de,e as ue}from"./dialog-BDMnm7Fp.js";import{I as l}from"./input-L_-VHgZB.js";import{L as d}from"./label-Ch3Qpvdb.js";import{T as me,a as he,b as z,c as B}from"./tabs-C6wBaPMQ.js";import{s as r}from"./toast-CBrN9sog.js";import{C as pe}from"./circle-check-Bn1A0iOv.js";import{T as xe}from"./trash-2-CT4TwgH7.js";import{S as fe}from"./site-header-1ZLAZI7i.js";import{T as ge}from"./textarea-2ialuiXC.js";/* empty css            */import"./index-BeHAPgjQ.js";import"./loader-circle-DS5R5jI-.js";import"./file-text-Cn-yV2BY.js";import"./user-BJizuUvm.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],ye=M("PenTool",je);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],R=M("Upload",be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],we=M("UserRound",Ne);function ve(){const x=i.useRef(null),[_,p]=i.useState(!1),[m,S]=i.useState([]),[o,c]=i.useState(!1),[h,f]=i.useState(null),[n,g]=i.useState(!1),[b,C]=i.useState(null);i.useEffect(()=>{j()},[]),i.useEffect(()=>{const a=x.current;if(!a)return;const s=a.getContext("2d");s&&(s.strokeStyle="#000000",s.lineWidth=2,s.lineCap="round",s.lineJoin="round",s.fillStyle="#ffffff",s.fillRect(0,0,a.width,a.height))},[]);const j=async()=>{try{const s=await(await fetch(route("signatures.index"))).json();console.log("Fetched signatures:",s),S(s.signatures||[])}catch(a){console.error("Failed to fetch signatures:",a)}},T=(a,s)=>{const t=s.getBoundingClientRect(),y="touches"in a?a.touches[0].clientX:a.clientX,w="touches"in a?a.touches[0].clientY:a.clientY,K=s.width/t.width,V=s.height/t.height,q=(y-t.left)*K,W=(w-t.top)*V;return{x:q,y:W}},D=a=>{a.preventDefault();const s=x.current;if(!s)return;const t=s.getContext("2d");if(!t)return;t.strokeStyle="#000000",t.lineWidth=2,t.lineCap="round",t.lineJoin="round",p(!0);const{x:y,y:w}=T(a,s);t.beginPath(),t.moveTo(y,w)},P=a=>{if(!_)return;a.preventDefault();const s=x.current;if(!s)return;const t=s.getContext("2d");if(!t)return;const{x:y,y:w}=T(a,s);t.lineTo(y,w),t.stroke()},N=()=>{p(!1)},F=()=>{const a=x.current;if(!a)return;const s=a.getContext("2d");s&&(s.fillStyle="#ffffff",s.fillRect(0,0,a.width,a.height))},I=async()=>{const a=x.current;if(a){c(!0);try{const s=a.toDataURL("image/png"),t=await fetch(route("signatures.store"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({signature:s,signature_type:"manual",is_default:m.length===0})});if(t.ok)r.success("✅ Signature saved successfully"),F(),j();else{const y=await t.json();r.error(`❌ ${y.message||"Failed to save signature"}`)}}catch{r.error("❌ An error occurred while saving signature")}finally{c(!1)}}},H=a=>{const s=a.target.files?.[0];if(s){if(!s.type.startsWith("image/")){r.error("❌ Please select an image file");return}if(s.size>2*1024*1024){r.error("❌ File size must be less than 2MB");return}f(s)}},O=async()=>{if(h){c(!0);try{const a=new FormData;a.append("signature_file",h),a.append("signature_type","uploaded"),a.append("is_default",m.length===0?"1":"0");const s=await fetch(route("signatures.upload"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:a});if(s.ok){r.success("✅ Signature uploaded successfully"),f(null);const t=document.getElementById("signature-file");t&&(t.value=""),j()}else{const t=await s.json();r.error(`❌ ${t.message||"Failed to upload signature"}`)}}catch{r.error("❌ An error occurred while uploading signature")}finally{c(!1)}}},X=async a=>{c(!0);try{const s=await fetch(route("signatures.setDefault",a),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(s.ok)r.success("✅ Default signature updated"),j();else{const t=await s.json();r.error(`❌ ${t.message||"Failed to set default signature"}`)}}catch{r.error("❌ An error occurred")}finally{c(!1)}},Z=async a=>{c(!0);try{const s=await fetch(route("signatures.destroy",a),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}});if(s.ok)r.success("✅ Tanda tangan berhasil dihapus"),j();else{const t=await s.json();r.error(`❌ ${t.message||"Gagal menghapus tanda tangan"}`)}}catch{r.error("❌ Terjadi kesalahan")}finally{c(!1),g(!1),C(null)}},J=a=>{C(a),g(!0)},G=()=>{b&&Z(b)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs(E,{children:[e.jsx(U,{children:"Digital Signature Management"}),e.jsx(L,{children:"Create and manage your digital signatures for document approval"})]}),e.jsx(k,{children:e.jsxs(me,{defaultValue:"draw",className:"w-full",children:[e.jsxs(he,{className:"grid w-full grid-cols-2",children:[e.jsxs(z,{value:"draw",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Draw Signature"]}),e.jsxs(z,{value:"upload",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Upload Signature"]})]}),e.jsxs(B,{value:"draw",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Draw your signature below"}),e.jsx("canvas",{ref:x,width:600,height:200,className:"w-full cursor-crosshair touch-none rounded-md border-2 border-dashed border-neutral-300 bg-white dark:border-neutral-700 dark:bg-neutral-950",onMouseDown:D,onMouseMove:P,onMouseUp:N,onMouseLeave:N,onTouchStart:D,onTouchMove:P,onTouchEnd:N})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{type:"button",variant:"outline",onClick:F,children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Clear"]}),e.jsx(u,{type:"button",onClick:I,disabled:o,children:"Save Signature"})]})]}),e.jsxs(B,{value:"upload",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"signature-file",children:"Upload signature image"}),e.jsx(l,{id:"signature-file",type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:H}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported formats: PNG, JPG, JPEG. Max size: 2MB"})]}),h&&e.jsxs("div",{className:"rounded-md border border-neutral-200 p-4 dark:border-neutral-800",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Selected file: ",h.name]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Size: ",(h.size/1024).toFixed(2)," KB"]})]}),e.jsxs(u,{type:"button",onClick:O,disabled:!h||o,children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Upload Signature"]})]})]})})]}),m.length>0&&e.jsxs(v,{children:[e.jsxs(E,{children:[e.jsx(U,{children:"My Signatures"}),e.jsx(L,{children:"Manage your saved signatures"})]}),e.jsx(k,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:m.map(a=>e.jsx(v,{className:"relative",children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx(A,{variant:a.is_default?"default":"secondary",children:a.signature_type==="manual"?"Drawn":"Uploaded"}),a.is_default&&e.jsxs(A,{variant:"outline",className:"ml-2",children:[e.jsx(pe,{className:"mr-1 h-3 w-3"}),"Default"]})]}),e.jsx("div",{className:"mb-4 flex h-32 items-center justify-center rounded border border-neutral-200 bg-white p-2 dark:border-neutral-800 dark:bg-neutral-950",children:e.jsx("img",{src:a.signature_url,alt:"Signature",className:"max-h-full max-w-full object-contain",onError:s=>{console.error("Failed to load signature image:",a),s.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIxOCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkVycm9yPC90ZXh0Pjwvc3ZnPg=="}})}),e.jsxs("div",{className:"flex gap-2",children:[!a.is_default&&e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>X(a.id),disabled:o,children:"Set as Default"}),e.jsx(u,{type:"button",variant:"destructive",size:"sm",onClick:()=>J(a.id),disabled:o,children:e.jsx(xe,{className:"h-4 w-4"})})]})]})},a.id))})})]}),e.jsx(le,{open:n,onOpenChange:g,children:e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ce,{className:"font-serif",children:"Hapus Tanda Tangan"}),e.jsx(de,{className:"font-sans",children:"Apakah Anda yakin ingin menghapus tanda tangan ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(ue,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>g(!1),className:"font-sans",disabled:o,children:"Batal"}),e.jsx(u,{type:"button",variant:"destructive",onClick:G,className:"font-sans",disabled:o,children:o?"Menghapus...":"Hapus"})]})]})})]})}function Oe({mustVerifyEmail:x,status:_}){const{auth:p}=$().props,[m,S]=i.useState(!1),[o,c]=i.useState(!1),[h,f]=i.useState(!1),[n,g]=i.useState({}),b=p.user?.user_auths?.[0]||p.user?.userAuths?.[0],C=b?.jabatan,j=b?.company,T=b?.aplikasi,D=p.user?.profile?.address||"",P=N=>{N.preventDefault();const F=new FormData(N.currentTarget);f(!0),g({}),Q.patch(route("profile.update"),F,{preserveScroll:!0,onSuccess:()=>{r.success("✓ Perubahan berhasil disimpan!"),S(!1),c(!1),f(!1)},onError:I=>{console.error("Form errors:",I),g(I),r.error("❌ Terjadi kesalahan. Periksa form Anda."),f(!1)},onFinish:()=>{f(!1)}})};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Profile"}),e.jsxs(ae,{children:[e.jsx(se,{}),e.jsx(te,{variant:"inset"}),e.jsxs(re,{children:[e.jsx(fe,{}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsxs("div",{className:"@container/main flex flex-1 flex-col gap-6 p-6",children:[e.jsx("form",{onSubmit:P,children:e.jsx(v,{children:e.jsxs(k,{className:"p-6",children:[e.jsx("div",{className:"mb-8 flex justify-center",children:e.jsx("div",{className:"flex h-32 w-32 items-center justify-center rounded-full bg-gradient-to-br from-teal-500 to-teal-700 text-white shadow-lg",children:e.jsx(we,{className:"h-20 w-20"})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Personal Information"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your personal details"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Nama Lengkap"}),e.jsx(l,{id:"name",name:"name",defaultValue:p.user.name,required:!0,autoComplete:"name",placeholder:"Masukkan nama lengkap"}),n.name&&e.jsx("p",{className:"text-sm text-red-500",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(l,{id:"email",name:"email",type:"email",defaultValue:p.user.email,required:!0,autoComplete:"email",placeholder:"email@example.com"}),n.email&&e.jsx("p",{className:"text-sm text-red-500",children:n.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Password"}),e.jsx(u,{type:"button",variant:"link",size:"sm",onClick:()=>S(!m),className:"h-auto p-0 text-sm",children:m?"Batal Ubah":"Ubah Password"})]}),!m&&e.jsx(l,{type:"password",value:"••••••••••••",disabled:!0}),m&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{type:"password",name:"current_password",placeholder:"Password saat ini",autoComplete:"current-password"}),e.jsx(l,{type:"password",name:"password",placeholder:"Password baru",autoComplete:"new-password"}),e.jsx(l,{type:"password",name:"password_confirmation",placeholder:"Konfirmasi password baru",autoComplete:"new-password"})]}),n.current_password&&e.jsx("p",{className:"text-sm text-red-500",children:n.current_password}),n.password&&e.jsx("p",{className:"text-sm text-red-500",children:n.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"alamat",children:"Alamat"}),e.jsx(ge,{id:"alamat",name:"alamat",defaultValue:D||"",placeholder:"Masukkan alamat lengkap",rows:3}),n.alamat&&e.jsx("p",{className:"text-sm text-red-500",children:n.alamat})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"PIN Tanda Tangan"}),e.jsx(u,{type:"button",variant:"link",size:"sm",onClick:()=>c(!o),className:"h-auto p-0 text-sm",children:o?"Batal Ubah":"Ubah PIN"})]}),!o&&e.jsx(l,{type:"password",value:"••••••",disabled:!0}),o&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{type:"password",name:"current_pin",placeholder:"PIN saat ini",maxLength:6}),e.jsx(l,{type:"password",name:"pin",placeholder:"PIN baru (6 digit)",maxLength:6}),e.jsx(l,{type:"password",name:"pin_confirmation",placeholder:"Konfirmasi PIN baru",maxLength:6})]}),n.pin&&e.jsx("p",{className:"text-sm text-red-500",children:n.pin})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"jabatan",children:"Jabatan"}),e.jsx(l,{id:"jabatan",value:C?.name||"-",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Jabatan dikelola oleh administrator"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"company",children:"Company"}),e.jsx(l,{id:"company",value:j?.name||"-",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Company dikelola oleh administrator"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"aplikasi",children:"Aplikasi"}),e.jsx(l,{id:"aplikasi",value:T?.name||"-",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aplikasi dikelola oleh administrator"})]})]})]}),e.jsx(ne,{className:"my-6"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(u,{type:"submit",disabled:h,children:h?"Menyimpan...":"Simpan Perubahan"})})]})})}),e.jsx(v,{children:e.jsxs(k,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Tanda Tangan Digital"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kelola tanda tangan digital Anda untuk proses approval dokumen"})]}),e.jsx(ve,{})]})})]})})]})]})]})}export{Oe as default};
